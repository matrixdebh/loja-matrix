<!DOCTYPE html>
<html lang="pt-BR">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Text2Video Studio - Crie Vídeos com Texto</title>
   <script src="https://cdn.tailwindcss.com"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
   <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
   <style>
       * {
           font-family: 'Inter', sans-serif;
       }
       h1, h2, h3, .brand {
           font-family: 'Space Grotesk', sans-serif;
       }
       
       /* Custom Scrollbar */
       ::-webkit-scrollbar {
           width: 8px;
           height: 8px;
       }
       ::-webkit-scrollbar-track {
           background: #0f172a;
       }
       ::-webkit-scrollbar-thumb {
           background: #334155;
           border-radius: 4px;
       }
       ::-webkit-scrollbar-thumb:hover {
           background: #475569;
       }

       /* Glassmorphism */
       .glass {
           background: rgba(15, 23, 42, 0.7);
           backdrop-filter: blur(12px);
           -webkit-backdrop-filter: blur(12px);
           border: 1px solid rgba(255, 255, 255, 0.1);
       }

       .glass-panel {
           background: rgba(30, 41, 59, 0.6);
           backdrop-filter: blur(10px);
           border: 1px solid rgba(255, 255, 255, 0.05);
       }

       /* Animations */
       @keyframes gradient-shift {
           0%, 100% { background-position: 0% 50%; }
           50% { background-position: 100% 50%; }
       }

       .gradient-bg {
           background: linear-gradient(-45deg, #0f172a, #1e1b4b, #312e81, #0f172a);
           background-size: 400% 400%;
           animation: gradient-shift 15s ease infinite;
       }

       .scene-card {
           transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
       }
       .scene-card:hover {
           transform: translateY(-2px);
           box-shadow: 0 10px 40px -10px rgba(99, 102, 241, 0.3);
       }

       .preview-text {
           text-shadow: 0 2px 4px rgba(0,0,0,0.5);
           animation: fadeInUp 0.6s ease-out;
       }

       @keyframes fadeInUp {
           from {
               opacity: 0;
               transform: translateY(20px);
           }
           to {
               opacity: 1;
               transform: translateY(0);
           }
       }

       .timeline-track {
           background: linear-gradient(90deg, #1e293b 0%, #334155 100%);
       }

       .playhead {
           box-shadow: 0 0 20px rgba(99, 102, 241, 0.8);
       }

       /* Range Slider Styling */
       input[type=range] {
           -webkit-appearance: none;
           background: transparent;
       }
       input[type=range]::-webkit-slider-thumb {
           -webkit-appearance: none;
           height: 16px;
           width: 16px;
           border-radius: 50%;
           background: #6366f1;
           cursor: pointer;
           margin-top: -6px;
           box-shadow: 0 0 10px rgba(99, 102, 241, 0.5);
       }
       input[type=range]::-webkit-slider-runnable-track {
           width: 100%;
           height: 4px;
           cursor: pointer;
           background: #334155;
           border-radius: 2px;
       }

       /* Recording Animation */
       @keyframes pulse-ring {
           0% { transform: scale(0.8); opacity: 0.5; }
           100% { transform: scale(2); opacity: 0; }
       }
       .recording-dot {
           animation: pulse 2s infinite;
       }
       @keyframes pulse {
           0%, 100% { opacity: 1; }
           50% { opacity: 0.5; }
       }
   </style>
</head>
<body class="gradient-bg text-white min-h-screen overflow-x-hidden">

   <!-- Header -->
   <header class="fixed top-0 w-full z-50 glass border-b border-white/10">
       <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
           <div class="flex items-center gap-3">
               <div class="w-10 h-10 bg-indigo-500 rounded-xl flex items-center justify-center shadow-lg shadow-indigo-500/30">
                   <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                   </svg>
               </div>
               <div>
                   <h1 class="text-xl font-bold tracking-tight">Text2Video Studio</h1>
                   <p class="text-xs text-slate-400">Crie vídeos profissionais com texto</p>
               </div>
           </div>
           
           <div class="flex items-center gap-4">
               <button onclick="app.importProject()" class="px-4 py-2 text-sm text-slate-300 hover:text-white transition-colors">
                   Importar
               </button>
               <button onclick="app.exportProject()" class="px-4 py-2 text-sm text-slate-300 hover:text-white transition-colors">
                   Exportar JSON
               </button>
               <button onclick="app.renderVideo()" class="px-6 py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg font-medium transition-all transform hover:scale-105 shadow-lg shadow-indigo-600/30 flex items-center gap-2">
                   <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path>
                       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                   </svg>
                   Renderizar Vídeo
               </button>
           </div>
       </div>
   </header>

   <!-- Main Content -->
   <main class="pt-24 pb-8 px-6 max-w-7xl mx-auto grid grid-cols-12 gap-6 h-[calc(100vh-6rem)]">
       
       <!-- Left Panel: Scene Editor -->
       <div class="col-span-4 flex flex-col gap-4 h-full overflow-hidden">
           
           <!-- Scene List -->
           <div class="glass-panel rounded-2xl p-6 flex-1 overflow-hidden flex flex-col">
               <div class="flex items-center justify-between mb-4">
                   <h2 class="text-lg font-semibold flex items-center gap-2">
                       <svg class="w-5 h-5 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                           <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                       </svg>
                       Cenas
                   </h2>
                   <button onclick="app.addScene()" class="w-8 h-8 bg-indigo-600 hover:bg-indigo-500 rounded-lg flex items-center justify-center transition-colors">
                       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                           <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                       </svg>
                   </button>
               </div>

               <div id="sceneList" class="space-y-3 overflow-y-auto flex-1 pr-2">
                   <!-- Scenes will be injected here -->
               </div>
           </div>

           <!-- Current Scene Editor -->
           <div id="sceneEditor" class="glass-panel rounded-2xl p-6 h-[45%] overflow-y-auto hidden">
               <h3 class="text-sm font-medium text-slate-400 uppercase tracking-wider mb-4">Editor de Cena</h3>
               
               <div class="space-y-4">
                   <div>
                       <label class="block text-sm font-medium mb-2">Texto na Tela</label>
                       <textarea id="sceneText" oninput="app.updateCurrentScene()" class="w-full bg-slate-800/50 border border-slate-700 rounded-lg p-3 text-sm focus:outline-none focus:border-indigo-500 transition-colors resize-none h-24" placeholder="Digite o texto que aparecerá no vídeo..."></textarea>
                   </div>

                   <div>
                       <label class="block text-sm font-medium mb-2">Imagem de Fundo</label>
                       <div class="grid grid-cols-4 gap-2 mb-2">
                           <button onclick="app.setBackground('gradient')" class="h-12 rounded-lg bg-gradient-to-br from-purple-600 to-blue-600 hover:ring-2 ring-white transition-all"></button>
                           <button onclick="app.setBackground('nature')" class="h-12 rounded-lg bg-gradient-to-br from-green-600 to-emerald-800 hover:ring-2 ring-white transition-all"></button>
                           <button onclick="app.setBackground('dark')" class="h-12 rounded-lg bg-gradient-to-br from-slate-800 to-black hover:ring-2 ring-white transition-all"></button>
                           <button onclick="app.setBackground('sunset')" class="h-12 rounded-lg bg-gradient-to-br from-orange-500 to-red-600 hover:ring-2 ring-white transition-all"></button>
                       </div>
                       <input type="text" id="bgUrl" onchange="app.updateCurrentScene()" placeholder="Ou URL da imagem..." class="w-full bg-slate-800/50 border border-slate-700 rounded-lg p-2 text-sm focus:outline-none focus:border-indigo-500">
                   </div>

                   <div class="grid grid-cols-2 gap-4">
                       <div>
                           <label class="block text-sm font-medium mb-2">Duração (s)</label>
                           <input type="number" id="sceneDuration" onchange="app.updateCurrentScene()" min="1" max="60" value="5" class="w-full bg-slate-800/50 border border-slate-700 rounded-lg p-2 text-sm focus:outline-none focus:border-indigo-500">
                       </div>
                       <div>
                           <label class="block text-sm font-medium mb-2">Animação</label>
                           <select id="sceneAnimation" onchange="app.updateCurrentScene()" class="w-full bg-slate-800/50 border border-slate-700 rounded-lg p-2 text-sm focus:outline-none focus:border-indigo-500">
                               <option value="fade">Fade In</option>
                               <option value="slide">Slide Up</option>
                               <option value="scale">Scale</option>
                               <option value="typewriter">Typewriter</option>
                           </select>
                       </div>
                   </div>

                   <div>
                       <label class="block text-sm font-medium mb-2">Narração (TTS)</label>
                       <textarea id="sceneNarration" oninput="app.updateCurrentScene()" class="w-full bg-slate-800/50 border border-slate-700 rounded-lg p-3 text-sm focus:outline-none focus:border-indigo-500 transition-colors resize-none h-16" placeholder="Texto para narração em voz..."></textarea>
                       <button onclick="app.playNarration()" class="mt-2 w-full py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-sm flex items-center justify-center gap-2 transition-colors">
                           <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path>
                           </svg>
                           Ouvir Narração
                       </button>
                   </div>
               </div>
           </div>
       </div>

       <!-- Center: Preview -->
       <div class="col-span-5 flex flex-col gap-4">
           <div class="glass-panel rounded-2xl p-1 flex-1 relative overflow-hidden group">
               <!-- Video Preview Area -->
               <div id="previewContainer" class="w-full h-full bg-black rounded-xl relative overflow-hidden flex items-center justify-center">
                   <div id="previewBackground" class="absolute inset-0 bg-gradient-to-br from-indigo-900 to-purple-900 transition-all duration-500"></div>
                   
                   <!-- Grid Overlay -->
                   <div class="absolute inset-0 opacity-20" style="background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.15) 1px, transparent 0); background-size: 20px 20px;"></div>
                   
                   <!-- Safe Zones -->
                   <div class="absolute inset-8 border border-white/20 rounded-lg pointer-events-none"></div>
                   <div class="absolute top-1/2 left-1/2 w-4 h-4 -mt-2 -ml-2 border border-white/30 rounded-full pointer-events-none"></div>
                   
                   <!-- Text Content -->
                   <div id="previewText" class="relative z-10 text-center px-12 max-w-2xl">
                       <h2 class="text-4xl font-bold mb-4 preview-text leading-tight">Seu Texto Aparecerá Aqui</h2>
                       <p class="text-lg text-white/80 preview-text">Edite as cenas à esquerda para começar</p>
                   </div>

                   <!-- Playback Controls Overlay -->
                   <div class="absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/80 to-transparent opacity-0 group-hover:opacity-100 transition-opacity">
                       <div class="flex items-center gap-4">
                           <button onclick="app.togglePlay()" id="playBtn" class="w-10 h-10 bg-white/20 hover:bg-white/30 rounded-full flex items-center justify-center backdrop-blur-sm transition-colors">
                               <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                   <path d="M8 5v14l11-7z"/>
                               </svg>
                           </button>
                           <div class="flex-1 h-1 bg-white/20 rounded-full overflow-hidden cursor-pointer" onclick="app.seek(event)">
                               <div id="progressBar" class="h-full bg-indigo-500 w-0 transition-all duration-100"></div>
                           </div>
                           <span id="timeDisplay" class="text-sm font-mono text-white/80">00:00 / 00:00</span>
                       </div>
                   </div>

                   <!-- Recording Indicator -->
                   <div id="recordingIndicator" class="absolute top-4 right-4 hidden items-center gap-2 bg-red-500/20 backdrop-blur-md px-3 py-1.5 rounded-full border border-red-500/30">
                       <div class="w-2 h-2 bg-red-500 rounded-full recording-dot"></div>
                       <span class="text-xs font-medium text-red-400">GRAVANDO</span>
                   </div>
               </div>

               <!-- Resolution Badge -->
               <div class="absolute top-4 left-4 px-3 py-1 bg-black/50 backdrop-blur-md rounded-full text-xs font-mono text-white/70 border border-white/10">
                   1920 × 1080 • 30fps
               </div>
           </div>

           <!-- Quick Actions -->
           <div class="glass-panel rounded-2xl p-4 flex items-center justify-between">
               <div class="flex items-center gap-4">
                   <button onclick="app.addScene()" class="flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg text-sm transition-colors">
                       <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                           <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                       </svg>
                       Nova Cena
                   </button>
                   <button onclick="app.duplicateScene()" class="flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg text-sm transition-colors">
                       <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                           <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                       </svg>
                       Duplicar
                   </button>
               </div>
               
               <div class="flex items-center gap-2">
                   <span class="text-xs text-slate-400">Zoom:</span>
                   <input type="range" min="50" max="150" value="100" class="w-24" oninput="app.setZoom(this.value)">
               </div>
           </div>
       </div>

       <!-- Right Panel: Timeline & Assets -->
       <div class="col-span-3 flex flex-col gap-4 h-full">
           
           <!-- Timeline -->
           <div class="glass-panel rounded-2xl p-6 flex-1 flex flex-col">
               <h2 class="text-lg font-semibold mb-4 flex items-center gap-2">
                   <svg class="w-5 h-5 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                   </svg>
                   Timeline
               </h2>
               
               <div class="flex-1 relative overflow-hidden">
                   <div id="timelineTrack" class="absolute inset-0 timeline-track rounded-lg overflow-x-auto overflow-y-hidden">
                       <div id="timelineScenes" class="flex h-full p-2 gap-1 min-w-full">
                           <!-- Timeline items injected here -->
                       </div>
                       
                       <!-- Playhead -->
                       <div id="playhead" class="absolute top-0 bottom-0 w-0.5 bg-indigo-500 z-20 pointer-events-none playhead" style="left: 0%">
                           <div class="absolute -top-1 -left-1.5 w-4 h-4 bg-indigo-500 rounded-full"></div>
                       </div>
                   </div>
               </div>

               <div class="mt-4 pt-4 border-t border-white/10 flex items-center justify-between text-xs text-slate-400">
                   <span>Total: <span id="totalDuration">0</span>s</span>
                   <span><span id="sceneCount">0</span> cenas</span>
               </div>
           </div>

           <!-- Assets Library -->
           <div class="glass-panel rounded-2xl p-6 h-[40%] overflow-hidden flex flex-col">
               <h3 class="text-sm font-medium text-slate-400 uppercase tracking-wider mb-4">Biblioteca de Assets</h3>
               
               <div class="grid grid-cols-2 gap-2 overflow-y-auto pr-1">
                   <div onclick="app.addAsset('gradient')" class="aspect-video rounded-lg bg-gradient-to-br from-indigo-600 to-purple-600 cursor-pointer hover:ring-2 ring-white transition-all relative group">
                       <span class="absolute inset-0 flex items-center justify-center text-xs font-medium opacity-0 group-hover:opacity-100 transition-opacity">Gradiente</span>
                   </div>
                   <div onclick="app.addAsset('particles')" class="aspect-video rounded-lg bg-slate-800 cursor-pointer hover:ring-2 ring-white transition-all relative group overflow-hidden">
                       <div class="absolute inset-0 opacity-50" style="background-image: radial-gradient(circle at 2px 2px, white 1px, transparent 0); background-size: 8px 8px;"></div>
                       <span class="absolute inset-0 flex items-center justify-center text-xs font-medium opacity-0 group-hover:opacity-100 transition-opacity bg-black/50">Partículas</span>
                   </div>
                   <div onclick="app.addAsset('geometric')" class="aspect-video rounded-lg bg-slate-800 cursor-pointer hover:ring-2 ring-white transition-all relative group overflow-hidden">
                       <svg class="absolute inset-0 w-full h-full opacity-30" viewBox="0 0 100 100">
                           <polygon points="50,10 90,90 10,90" fill="none" stroke="white" stroke-width="2"/>
                       </svg>
                       <span class="absolute inset-0 flex items-center justify-center text-xs font-medium opacity-0 group-hover:opacity-100 transition-opacity bg-black/50">Geométrico</span>
                   </div>
                   <div onclick="app.addAsset('noise')" class="aspect-video rounded-lg bg-slate-700 cursor-pointer hover:ring-2 ring-white transition-all relative group">
                       <div class="absolute inset-0 opacity-20" style="background-image: url('data:image/svg+xml,%3Csvg viewBox=%220 0 200 200%22 xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cfilter  id=%22noise%22%3E%3CfeTurbulence type=%22fractalNoise%22 baseFrequency=%220.65%22 numOctaves=%223%22 stitchTiles=%22stitch%22/%3E%3C/filter%3E%3Crect width=%22100%25%22 height=%22100%25%22 filter=%22url(%23noise)%22 opacity=%221%22/%3E%3C/svg%3E');"></div>
                       <span class="absolute inset-0 flex items-center justify-center text-xs font-medium opacity-0 group-hover:opacity-100 transition-opacity bg-black/50">Textura</span>
                   </div>
               </div>

               <div class="mt-4 pt-4 border-t border-white/10">
                   <button onclick="app.uploadAsset()" class="w-full py-2 border border-dashed border-slate-600 hover:border-indigo-500 rounded-lg text-sm text-slate-400 hover:text-indigo-400 transition-colors flex items-center justify-center gap-2">
                       <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                           <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                       </svg>
                       Upload de Imagem
                   </button>
               </div>
           </div>
       </div>
   </main>

   <!-- Render Modal -->
   <div id="renderModal" class="fixed inset-0 z-[100] hidden">
       <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="app.closeRenderModal()"></div>
       <div class="absolute inset-0 flex items-center justify-center p-6">
           <div class="glass-panel rounded-2xl p-8 max-w-md w-full transform transition-all scale-100">
               <div id="renderProgress">
                   <div class="flex items-center justify-center mb-6">
                       <div class="w-16 h-16 border-4 border-indigo-500/30 border-t-indigo-500 rounded-full animate-spin"></div>
                   </div>
                   <h3 class="text-xl font-bold text-center mb-2">Renderizando Vídeo...</h3>
                   <p class="text-slate-400 text-center text-sm mb-6">Processando <span id="renderCurrent">1</span> de <span id="renderTotal">3</span> cenas</p>
                   
                   <div class="w-full bg-slate-800 rounded-full h-2 mb-2 overflow-hidden">
                       <div id="renderBar" class="h-full bg-indigo-500 transition-all duration-300" style="width: 0%"></div>
                   </div>
                   <p id="renderStatus" class="text-xs text-slate-500 text-center font-mono">Inicializando encoder...</p>
               </div>

               <div id="renderComplete" class="hidden text-center">
                   <div class="w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4">
                       <svg class="w-8 h-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                           <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                       </svg>
                   </div>
                   <h3 class="text-xl font-bold mb-2">Vídeo Pronto!</h3>
                   <p class="text-slate-400 text-sm mb-6">Seu vídeo foi renderizado com sucesso.</p>
                   
                   <div class="space-y-3">
                       <button onclick="app.downloadVideo()" class="w-full py-3 bg-indigo-600 hover:bg-indigo-500 rounded-lg font-medium transition-colors flex items-center justify-center gap-2">
                           <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                           </svg>
                           Baixar MP4
                       </button>
                       <button onclick="app.closeRenderModal()" class="w-full py-3 bg-slate-800 hover:bg-slate-700 rounded-lg text-sm transition-colors">
                           Fechar
                       </button>
                   </div>
               </div>
           </div>
       </div>
   </div>

   <script>
       class Text2VideoApp {
           constructor() {
               this.scenes = [
                   {
                       id: 1,
                       text: "Bem-vindo ao\nText2Video Studio",
                       subtext: "Crie vídeos incríveis apenas com texto",
                       background: "gradient",
                       duration: 5,
                       animation: "fade",
                       narration: "Bem-vindo ao Text2Video Studio. Crie vídeos incríveis apenas com texto."
                   }
               ];
               this.currentSceneId = 1;
               this.isPlaying = false;
               this.currentTime = 0;
               this.totalDuration = 5;
               this.playInterval = null;
               this.zoom = 100;
               
               this.init();
           }

           init() {
               this.renderSceneList();
               this.renderTimeline();
               this.selectScene(1);
               this.updateStats();
           }

           addScene() {
               const newId = Math.max(...this.scenes.map(s => s.id), 0) + 1;
               const newScene = {
                   id: newId,
                   text: `Nova Cena ${newId}`,
                   subtext: "Descrição da cena",
                   background: "gradient",
                   duration: 5,
                   animation: "fade",
                   narration: ""
               };
               this.scenes.push(newScene);
               this.renderSceneList();
               this.renderTimeline();
               this.selectScene(newId);
               this.updateStats();
           }

           duplicateScene() {
               if (!this.currentSceneId) return;
               const scene = this.scenes.find(s => s.id === this.currentSceneId);
               if (scene) {
                   const newScene = {...scene, id: Math.max(...this.scenes.map(s => s.id)) + 1};
                   this.scenes.push(newScene);
                   this.renderSceneList();
                   this.renderTimeline();
                   this.selectScene(newScene.id);
                   this.updateStats();
               }
           }

           deleteScene(id, event) {
               event.stopPropagation();
               if (this.scenes.length <= 1) {
                   alert("Você precisa ter pelo menos uma cena!");
                   return;
               }
               this.scenes = this.scenes.filter(s => s.id !== id);
               if (this.currentSceneId === id) {
                   this.currentSceneId = this.scenes[0]?.id || null;
               }
               this.renderSceneList();
               this.renderTimeline();
               if (this.currentSceneId) this.selectScene(this.currentSceneId);
               this.updateStats();
           }

           selectScene(id) {
               this.currentSceneId = id;
               const scene = this.scenes.find(s => s.id === id);
               
               // Update UI selection
               document.querySelectorAll('.scene-card').forEach(card => {
                   card.classList.remove('ring-2', 'ring-indigo-500', 'bg-indigo-500/20');
                   if (parseInt(card.dataset.id) === id) {
                       card.classList.add('ring-2', 'ring-indigo-500', 'bg-indigo-500/20');
                   }
               });

               // Show editor
               document.getElementById('sceneEditor').classList.remove('hidden');
               
               // Populate fields
               document.getElementById('sceneText').value = scene.text;
               document.getElementById('bgUrl').value = scene.background.startsWith('http') ? scene.background : '';
               document.getElementById('sceneDuration').value = scene.duration;
               document.getElementById('sceneAnimation').value = scene.animation;
               document.getElementById('sceneNarration').value = scene.narration || '';

               // Update preview
               this.updatePreview(scene);
           }

           updateCurrentScene() {
               const scene = this.scenes.find(s => s.id === this.currentSceneId);
               if (!scene) return;

               scene.text = document.getElementById('sceneText').value;
               scene.duration = parseInt(document.getElementById('sceneDuration').value) || 5;
               scene.animation = document.getElementById('sceneAnimation').value;
               scene.narration = document.getElementById('sceneNarration').value;
               
               const bgUrl = document.getElementById('bgUrl').value;
               if (bgUrl) scene.background = bgUrl;

               this.updatePreview(scene);
               this.renderSceneList();
               this.renderTimeline();
               this.updateStats();
           }

           setBackground(type) {
               const scene = this.scenes.find(s => s.id === this.currentSceneId);
               if (scene) {
                   scene.background = type;
                   document.getElementById('bgUrl').value = '';
                   this.updateCurrentScene();
               }
           }

           updatePreview(scene) {
               const previewBg = document.getElementById('previewBackground');
               const previewText = document.getElementById('previewText');
               
               // Background
               const bgMap = {
                   'gradient': 'linear-gradient(135deg, #4f46e5 0%, #7c3aed 50%, #db2777 100%)',
                   'nature': 'linear-gradient(135deg, #059669 0%, #047857 50%, #065f46 100%)',
                   'dark': 'linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #000000 100%)',
                   'sunset': 'linear-gradient(135deg, #f97316 0%, #ea580c 50%, #dc2626 100%)'
               };
               
               if (bgMap[scene.background]) {
                   previewBg.style.background = bgMap[scene.background];
               } else if (scene.background.startsWith('http')) {
                   previewBg.style.background = `url(${scene.background}) center/cover`;
               } else {
                   previewBg.style.background = bgMap['gradient'];
               }

               // Text with animation
               const lines = scene.text.split('\n');
               const mainText = lines[0] || 'Sem Título';
               const subText = lines.slice(1).join(' ') || scene.subtext || '';
               
               let animationClass = 'preview-text';
               if (scene.animation === 'slide') animationClass += ' animate-bounce';
               if (scene.animation === 'scale') animationClass += ' transform scale-110';
               
               previewText.innerHTML = `
                   <h2 class="text-4xl font-bold mb-4 ${animationClass} leading-tight">${mainText}</h2>
                   ${subText ? `<p class="text-lg text-white/80 ${animationClass}" style="animation-delay: 0.2s">${subText}</p>` : ''}
               `;

               // Apply animation styles
               if (scene.animation === 'typewriter') {
                   previewText.querySelector('h2').style.animation = 'none';
                   previewText.querySelector('h2').style.overflow = 'hidden';
                   previewText.querySelector('h2').style.borderRight = '2px solid white';
                   previewText.querySelector('h2').style.whiteSpace = 'nowrap';
                   previewText.querySelector('h2').style.animation = 'typing 3s steps(40, end), blink-caret 0.75s step-end infinite';
               }
           }

           renderSceneList() {
               const container = document.getElementById('sceneList');
               container.innerHTML = this.scenes.map((scene, index) => `
                   <div class="scene-card bg-slate-800/50 rounded-xl p-4 cursor-pointer border border-white/5 ${scene.id === this.currentSceneId ? 'ring-2 ring-indigo-500 bg-indigo-500/20' : ''}" 
                        data-id="${scene.id}" onclick="app.selectScene(${scene.id})">
                       <div class="flex items-start justify-between mb-2">
                           <div class="flex items-center gap-3">
                               <div class="w-8 h-8 bg-slate-700 rounded-lg flex items-center justify-center text-xs font-bold text-slate-300">
                                   ${index + 1}
                               </div>
                               <div class="w-12 h-8 rounded bg-slate-700 overflow-hidden">
                                   <div class="w-full h-full ${this.getBgClass(scene.background)}"></div>
                               </div>
                           </div>
                           <button onclick="app.deleteScene(${scene.id}, event)" class="text-slate-500 hover:text-red-400 transition-colors">
                               <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                   <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                               </svg>
                           </button>
                       </div>
                       <h4 class="font-medium text-sm text-white mb-1 line-clamp-2">${scene.text.split('\n')[0]}</h4>
                       <div class="flex items-center gap-2 text-xs text-slate-400">
                           <span>${scene.duration}s</span>
                           <span>•</span>
                           <span class="capitalize">${scene.animation}</span>
                       </div>
                   </div>
               `).join('');
           }

           getBgClass(bg) {
               const map = {
                   'gradient': 'bg-gradient-to-br from-indigo-600 to-purple-600',
                   'nature': 'bg-gradient-to-br from-green-600 to-emerald-800',
                   'dark': 'bg-gradient-to-br from-slate-800 to-black',
                   'sunset': 'bg-gradient-to-br from-orange-500 to-red-600'
               };
               return map[bg] || 'bg-gradient-to-br from-indigo-600 to-purple-600';
           }

           renderTimeline() {
               const container = document.getElementById('timelineScenes');
               const totalDur = this.scenes.reduce((acc, s) => acc + s.duration, 0);
               
               container.innerHTML = this.scenes.map(scene => {
                   const width = (scene.duration / totalDur) * 100;
                   return `
                       <div class="h-full bg-indigo-600/30 border border-indigo-500/30 rounded relative group cursor-pointer hover:bg-indigo-600/50 transition-colors flex items-center justify-center text-xs font-medium overflow-hidden"
                            style="width: ${width}%"
                            onclick="app.selectScene(${scene.id}); app.seekToScene(${scene.id})">
                           <span class="truncate px-2">${scene.text.substring(0, 20)}</span>
                           <div class="absolute bottom-0 left-0 h-1 bg-indigo-500" style="width: ${scene.id === this.currentSceneId ? '100%' : '0%'}"></div>
                       </div>
                   `;
               }).join('');
           }

           updateStats() {
               const total = this.scenes.reduce((acc, s) => acc + s.duration, 0);
               document.getElementById('totalDuration').textContent = total;
               document.getElementById('sceneCount').textContent = this.scenes.length;
               
               const mins = Math.floor(total / 60);
               const secs = total % 60;
               document.getElementById('timeDisplay').textContent = 
                   `00:00 / ${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
           }

           togglePlay() {
               if (this.isPlaying) {
                   this.pause();
               } else {
                   this.play();
               }
           }

           play() {
               this.isPlaying = true;
               document.getElementById('playBtn').innerHTML = `
                   <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                       <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                   </svg>
               `;
               
               let currentSceneIndex = 0;
               let sceneStartTime = 0;
               
               this.playInterval = setInterval(() => {
                   this.currentTime += 0.1;
                   
                   // Find current scene
                   let accumulated = 0;
                   for (let i = 0; i < this.scenes.length; i++) {
                       if (this.currentTime >= accumulated && this.currentTime < accumulated + this.scenes[i].duration) {
                           if (currentSceneIndex !== i) {
                               currentSceneIndex = i;
                               this.selectScene(this.scenes[i].id);
                           }
                           break;
                       }
                       accumulated += this.scenes[i].duration;
                   }
                   
                   // Update progress
                   const total = this.scenes.reduce((acc, s) => acc + s.duration, 0);
                   const progress = (this.currentTime / total) * 100;
                   document.getElementById('progressBar').style.width = `${Math.min(progress, 100)}%`;
                   document.getElementById('playhead').style.left = `${Math.min(progress, 100)}%`;
                   
                   // Update time display
                   const mins = Math.floor(this.currentTime / 60);
                   const secs = Math.floor(this.currentTime % 60);
                   const totalMins = Math.floor(total / 60);
                   const totalSecs = total % 60;
                   document.getElementById('timeDisplay').textContent = 
                       `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')} / ${totalMins.toString().padStart(2, '0')}:${totalSecs.toString().padStart(2, '0')}`;
                   
                   // Stop at end
                   if (this.currentTime >= total) {
                       this.pause();
                       this.currentTime = 0;
                   }
               }, 100);
           }

           pause() {
               this.isPlaying = false;
               clearInterval(this.playInterval);
               document.getElementById('playBtn').innerHTML = `
                   <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                       <path d="M8 5v14l11-7z"/>
                   </svg>
               `;
           }

           seek(event) {
               const rect = event.currentTarget.getBoundingClientRect();
               const x = event.clientX - rect.left;
               const percent = x / rect.width;
               const total = this.scenes.reduce((acc, s) => acc + s.duration, 0);
               this.currentTime = total * percent;
               
               // Update UI
               document.getElementById('progressBar').style.width = `${percent * 100}%`;
               document.getElementById('playhead').style.left = `${percent * 100}%`;
               
               // Find and show scene at this time
               let accumulated = 0;
               for (let scene of this.scenes) {
                   if (this.currentTime >= accumulated && this.currentTime < accumulated + scene.duration) {
                       this.selectScene(scene.id);
                       break;
                   }
                   accumulated += scene.duration;
               }
           }

           seekToScene(id) {
               let accumulated = 0;
               for (let scene of this.scenes) {
                   if (scene.id === id) {
                       this.currentTime = accumulated;
                       const total = this.scenes.reduce((acc, s) => acc + s.duration, 0);
                       const percent = (accumulated / total) * 100;
                       document.getElementById('progressBar').style.width = `${percent}%`;
                       document.getElementById('playhead').style.left = `${percent}%`;
                       break;
                   }
                   accumulated += scene.duration;
               }
           }

           setZoom(value) {
               this.zoom = value;
               const container = document.getElementById('previewContainer');
               container.style.transform = `scale(${value / 100})`;
           }

           playNarration() {
               const scene = this.scenes.find(s => s.id === this.currentSceneId);
               if (scene && scene.narration && 'speechSynthesis' in window) {
                   const utterance = new SpeechSynthesisUtterance(scene.narration);
                   utterance.lang = 'pt-BR';
                   utterance.rate = 0.9;
                   speechSynthesis.speak(utterance);
               }
           }

           addAsset(type) {
               const scene = this.scenes.find(s => s.id === this.currentSceneId);
               if (scene) {
                   scene.background = type;
                   this.updateCurrentScene();
               }
           }

           uploadAsset() {
               const input = document.createElement('input');
               input.type = 'file';
               input.accept = 'image/*';
               input.onchange = (e) => {
                   const file = e.target.files[0];
                   if (file) {
                       const url = URL.createObjectURL(file);
                       const scene = this.scenes.find(s => s.id === this.currentSceneId);
                       if (scene) {
                           scene.background = url;
                           this.updateCurrentScene();
                       }
                   }
               };
               input.click();
           }

           renderVideo() {
               const modal = document.getElementById('renderModal');
               modal.classList.remove('hidden');
               
               document.getElementById('renderProgress').classList.remove('hidden');
               document.getElementById('renderComplete').classList.add('hidden');
               
               const total = this.scenes.length;
               document.getElementById('renderTotal').textContent = total;
               
               let current = 0;
               const interval = setInterval(() => {
                   current++;
                   const percent = (current / total) * 100;
                   
                   document.getElementById('renderCurrent').textContent = current;
                   document.getElementById('renderBar').style.width = `${percent}%`;
                   document.getElementById('renderStatus').textContent = 
                       `Processando cena ${current}: ${this.scenes[current-1]?.text.substring(0, 30)}...`;
                   
                   // Show recording indicator during render
                   document.getElementById('recordingIndicator').classList.remove('hidden');
                   document.getElementById('recordingIndicator').classList.add('flex');
                   
                   if (current >= total) {
                       clearInterval(interval);
                       setTimeout(() => {
                           document.getElementById('renderProgress').classList.add('hidden');
                           document.getElementById('renderComplete').classList.remove('hidden');
                           document.getElementById('recordingIndicator').classList.add('hidden');
                           document.getElementById('recordingIndicator').classList.remove('flex');
                       }, 500);
                   }
               }, 800);
           }

           closeRenderModal() {
               document.getElementById('renderModal').classList.add('hidden');
           }

           downloadVideo() {
               // Create a simple video file (in reality, this would use FFmpeg.js or similar)
               const canvas = document.createElement('canvas');
               canvas.width = 1920;
               canvas.height = 1080;
               const ctx = canvas.getContext('2d');
               
               // Draw current frame
               ctx.fillStyle = '#0f172a';
               ctx.fillRect(0, 0, canvas.width, canvas.height);
               ctx.fillStyle = 'white';
               ctx.font = 'bold 60px Arial';
               ctx.textAlign = 'center';
               ctx.fillText('Text2Video Export', canvas.width/2, canvas.height/2);
               
               // Download as image (simulating video)
               const link = document.createElement('a');
               link.download = 'meu-video-text2video.png';
               link.href = canvas.toDataURL();
               link.click();
               
               alert('Em uma implementação real, isto baixaria um arquivo MP4. Por enquanto, baixamos uma imagem representativa do projeto.');
           }

           exportProject() {
               const data = JSON.stringify(this.scenes, null, 2);
               const blob = new Blob([data], {type: 'application/json'});
               const url = URL.createObjectURL(blob);
               const link = document.createElement('a');
               link.download = 'text2video-project.json';
               link.href = url;
               link.click();
           }

           importProject() {
               const input = document.createElement('input');
               input.type = 'file';
               input.accept = '.json';
               input.onchange = (e) => {
                   const file = e.target.files[0];
                   const reader = new FileReader();
                   reader.onload = (event) => {
                       try {
                           this.scenes = JSON.parse(event.target.result);
                           this.currentSceneId = this.scenes[0]?.id || null;
                           this.renderSceneList();
                           this.renderTimeline();
                           if (this.currentSceneId) this.selectScene(this.currentSceneId);
                           this.updateStats();
                           alert('Projeto importado com sucesso!');
                       } catch (err) {
                           alert('Erro ao importar projeto');
                       }
                   };
                   reader.readAsText(file);
               };
               input.click();
           }
       }

       // Initialize app
       const app = new Text2VideoApp();

       // Add keyboard shortcuts
       document.addEventListener('keydown', (e) => {
           if (e.target.tagName === 'TEXTAREA' || e.target.tagName === 'INPUT') return;
           
           if (e.code === 'Space') {
               e.preventDefault();
               app.togglePlay();
           }
           if (e.code === 'KeyN' && e.ctrlKey) {
               e.preventDefault();
               app.addScene();
           }
       });

       // Add CSS for typewriter animation
       const style = document.createElement('style');
       style.textContent = `
           @keyframes typing {
               from { width: 0 }
               to { width: 100% }
           }
           @keyframes blink-caret {
               from, to { border-color: transparent }
               50% { border-color: white; }
           }
       `;
       document.head.appendChild(style);
   </script>
</body>
</html>